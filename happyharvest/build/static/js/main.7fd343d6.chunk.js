(this.webpackJsonphappyharvest=this.webpackJsonphappyharvest||[]).push([[0],{25:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var r=n(0),s=n.n(r),a=n(21),o=n.n(a),i=(n(25),n(9)),c=n(10),p=n(12),l=n(11),u=n(5),h=n(4),d=n(7),j="signIn:updateSignInForm",g="signIn:resetSignInForm",b="signIn:updateSignInMessage";function m(e){return{type:j,payload:{name:e.target.name,value:e.target.value}}}function v(){return{type:g,payload:{}}}function O(e){return{type:b,payload:{msg:e}}}var f=n(19),U="currentUser:setUser",x="currentUser:logOut";function y(e){return{type:U,payload:{username:e.username?e.username:"",fullname:e.fullname?e.fullname:"",email:e.email?e.email:"",registration:e.registration?e.registration:0,farmElements:{cropSpaces:e.farmElements.cropSpaces?e.farmElements.cropSpaces:0,animalSpaces:e.farmElements.animalSpaces?e.farmElements.animalSpaces:0,currentCrops:e.farmElements.currentCrops?Object(f.a)(e.farmElements.currentCrops):[],currentAnimals:e.farmElements.currentAnimals?Object(f.a)(e.farmElements.currentAnimals):[]},inventory:{currentCash:e.inventory.currentCash?e.inventory.currentCash:0,cropBoost:e.inventory.cropBoost?e.inventory.cropBoost:0,animalBoost:e.inventory.animalBoost?e.inventory.animalBoost:0,products:e.inventory.products?Object(f.a)(e.inventory.products):[],seeds:e.inventory.seeds?Object(f.a)(e.inventory.seeds):[]}}}}function S(){return{type:x,payload:{}}}var C=n(37),w="auth:setToken";function k(e){return{type:w,payload:{authToken:e}}}var E=n(1),T=function(e){Object(p.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).handleChange=r.handleChange.bind(Object(u.a)(r)),r.handleClick=r.handleClick.bind(Object(u.a)(r)),r.handleKeyPress=r.handleKeyPress.bind(Object(u.a)(r)),r}return Object(c.a)(n,[{key:"handleKeyPress",value:function(e){"Enter"===e.key&&this.handleClick()}},{key:"handleChange",value:function(e){this.props.onUpdateSignInForm(e)}},{key:"handleClick",value:function(){var e=this,t=this.props.cookies,n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:this.props.signIn.username?String(this.props.signIn.username):"-",password:this.props.signIn.password?String(this.props.signIn.password):"-"})};fetch("http://10.6.130.90/users/auth",n).then((function(e){return e.json()})).then((function(n){"true"===n.status?(e.props.onUpdateSignInMessage(""),e.props.onSetUser(n),n.authToken&&(t.set("authToken",n.authToken,{path:"/"}),t.set("authUser",n.username,{path:"/"}),e.props.onSetToken(t.get("authToken")))):e.props.onUpdateSignInMessage(n.msg)})).catch((function(e){alert(e)}))}},{key:"render",value:function(){return Object(E.jsxs)("form",{className:"Login",children:[Object(E.jsx)("h2",{children:"Introduzca sus datos:"}),Object(E.jsx)("input",{type:"text",placeholder:"Usuario",name:"username",onChange:this.handleChange}),Object(E.jsx)("input",{type:"password",placeholder:"Contrase\xf1a",name:"password",onChange:this.handleChange,onKeyPress:this.handleKeyPress}),Object(E.jsx)("button",{type:"button",onClick:this.handleClick,children:"Enviar"}),Object(E.jsx)("br",{}),Object(E.jsx)("p",{children:this.props.signIn.msg})]})}}]),n}(s.a.Component),I=Object(C.a)(Object(d.b)((function(e,t){return{currentUser:e.currentUser,signIn:e.signIn,auth:e.auth}}),(function(e,t){return Object(h.a)({onUpdateSignInForm:m,onResetSignInForm:v,onUpdateSignInMessage:O,onSetUser:y,onLogOut:S,onSetToken:k},e)}))(T));var P=function(e){return Object(E.jsx)("div",{style:{minHeight:"800px",marginTop:"5%",marginBottom:"5%",marginLeft:"20%",marginRight:"20%",width:"60%",backgroundColor:"white",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"},children:e.children})},B=n(2);var L=function(e){return""===e.props.username?Object(E.jsx)("div",{children:Object(E.jsxs)(P,{children:[Object(E.jsx)("br",{}),Object(E.jsx)(I,{})]})}):Object(E.jsx)(B.a,{to:"/"})},M=n(6),F="signUp:updateSignUpForm",A="signUp:resetSignUpForm",R="signUp:updateSignUpMessage";function H(e){return{type:F,payload:{name:e.target.name,value:e.target.value}}}function z(){return{type:A,payload:{}}}function D(e){return{type:R,payload:{validUser:e.validUser,validPassword:e.validPassword,validEmail:e.validEmail}}}var _=function(e){Object(p.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).handleChange=e.handleChange.bind(Object(u.a)(e)),e.handleClick=e.handleClick.bind(Object(u.a)(e)),e}return Object(c.a)(n,[{key:"handleChange",value:function(e){this.props.onUpdateSignUpForm(e)}},{key:"handleClick",value:function(){var e=this;this.props.onUpdateSignUpMessage({validUser:"",validPassword:"",validEmail:""});var t=!0,n=/[^a-z0-9]/i;if(this.props.signUp.username.length<=5&&(this.props.onUpdateSignUpMessage({validUser:"El nombre de usuario debe contener al menos 6 caracteres"}),t=!1),n.test(this.props.signUp.username)&&(this.props.onUpdateSignUpMessage({validUser:"El nombre de usuario no debe contener caracteres especiales"}),t=!1),this.props.signUp.password.length<=5&&(this.props.onUpdateSignUpMessage({validPassword:"La contrase\xf1a debe contener al menos 6 caracteres"}),t=!1),n.test(this.props.signUp.password)&&(this.props.onUpdateSignUpMessage({validPassword:"La contrase\xf1a no debe contener caracteres especiales"}),t=!1),this.props.signUp.password!==this.props.signUp.passwordRepeat&&(this.props.onUpdateSignUpMessage({validPassword:"La contrase\xf1a no coincide"}),t=!1),/^([a-z]|[0-9])+@([a-z]|[0-9])+(\.([a-z][a-z])+)+/i.test(this.props.signUp.email)||(this.props.onUpdateSignUpMessage({validEmail:"Introduzca un correo con formato v\xe1lido: examplemail@example.com"}),t=!1),t){var r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:this.props.signUp.username?String(this.props.signUp.username):"-",password:this.props.signUp.password?String(this.props.signUp.password):"-",email:this.props.signUp.email?String(this.props.signUp.email):"-"})};fetch("http://10.6.130.90/users",r).then((function(e){return e.json()})).then((function(t){console.log(t),"res"===t.type?(e.props.onUpdateSignUpForm({target:{name:"register",value:"true"===t.register}}),e.props.onUpdateSignUpMessage({validUser:t.validUser?t.validUser:"",validPassword:t.validPassword?t.validPassword:"",validEmail:t.validEmail?t.validEmail:""})):alert(t.msg)})).catch((function(e){alert(e)}))}}},{key:"render",value:function(){var e={color:"red"},t=Object(E.jsxs)("div",{children:[Object(E.jsx)("h1",{children:"Registro"}),Object(E.jsxs)("form",{className:"Login",children:[Object(E.jsx)("h2",{children:"Introduzca sus datos:"}),Object(E.jsx)("input",{type:"text",placeholder:"Usuario",name:"username",onChange:this.handleChange}),Object(E.jsx)("p",{style:e,children:this.props.signUp.validUser}),Object(E.jsx)("input",{type:"text",placeholder:"Correo electr\xf3nico",name:"email",onChange:this.handleChange}),Object(E.jsx)("p",{style:e,children:this.props.signUp.validEmail}),Object(E.jsx)("input",{type:"password",placeholder:"Contrase\xf1a",name:"password",onChange:this.handleChange}),Object(E.jsx)("input",{type:"password",placeholder:"Repetir contrase\xf1a",name:"passwordRepeat",onChange:this.handleChange}),Object(E.jsx)("p",{style:e,children:this.props.signUp.validPassword}),Object(E.jsx)("button",{type:"button",onClick:this.handleClick,children:"Registrarme"}),Object(E.jsx)("br",{}),Object(E.jsx)("p",{children:this.props.signUp.msg})]})]}),n=Object(E.jsxs)("div",{children:[Object(E.jsx)("h1",{children:"Usted ha sido registrado satisfactoriamente"}),Object(E.jsx)(M.b,{to:"/signin",children:Object(E.jsx)("button",{children:"Iniciar sesi\xf3n"})})]});return this.props.signUp.register?n:t}}]),n}(s.a.Component),N=Object(d.b)((function(e,t){return{signUp:e.signUp}}),(function(e,t){return Object(h.a)({onUpdateSignUpForm:H,onResetSignUpForm:z,onUpdateSignUpMessage:D},e)}))(_);var K=function(e){return""===e.props.username?Object(E.jsx)("div",{children:Object(E.jsx)(P,{children:Object(E.jsx)(N,{})})}):Object(E.jsx)(B.a,{to:"/"})},J=function(e){Object(p.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).handleClick=r.handleClick.bind(Object(u.a)(r)),r}return Object(c.a)(n,[{key:"handleClick",value:function(){var e=this.props.cookies;this.props.onLogOut(),this.props.onSetToken(""),e.set("authToken",void 0,{path:"/"}),e.set("authUser",void 0,{path:"/"})}},{key:"render",value:function(){var e={height:"10%",width:"100%",backgroundColor:"green",color:"white"},t=Object(E.jsxs)("nav",{style:e,children:[Object(E.jsx)("h1",{style:{margin:"0px"},children:"\xa1Bienvenido a HappyHarvest!"}),Object(E.jsx)(M.b,{to:"/",children:Object(E.jsx)("button",{children:"Home"})}),Object(E.jsx)(M.b,{to:"/signin",children:Object(E.jsx)("button",{children:"Login"})}),Object(E.jsx)(M.b,{to:"/signup",children:Object(E.jsx)("button",{children:"Registrarse"})})]}),n=Object(E.jsxs)("nav",{style:e,children:[Object(E.jsx)("h1",{style:{margin:"0px"},children:"\xa1Bienvenido a HappyHarvest!"}),Object(E.jsx)(M.b,{to:"/",children:Object(E.jsx)("button",{children:"Home"})}),Object(E.jsx)("button",{type:"button",onClick:this.handleClick,children:"Cerrar sesi\xf3n"})]});return""===this.props.currentUser.username?t:n}}]),n}(s.a.Component),X=Object(C.a)(Object(d.b)((function(e,t){return{currentUser:e.currentUser,auth:e.auth}}),(function(e,t){return Object(h.a)({onLogOut:S,onSetToken:k},e)}))(J));var G=function(){return Object(E.jsxs)("footer",{style:{position:"absolute",width:"100%",backgroundColor:"green",color:"white",display:"inline"},children:[Object(E.jsx)("p",{children:"Acerca de:"}),Object(E.jsx)("p",{children:"Alu0101..."}),Object(E.jsx)("p",{children:"Alu0101..."})]})};var V=function(e){return""===e.props.username?Object(E.jsxs)(P,{children:[Object(E.jsx)("br",{}),Object(E.jsxs)("div",{className:"Welcome",children:[Object(E.jsx)("h1",{children:" \xa1Bienvenido a HappyHarvest! "}),Object(E.jsx)("p",{children:"Actualmente no se encuentra registrado, por favor, cree una cuenta. En caso de tener una cuenta inicie sesi\xf3n."}),Object(E.jsx)(M.b,{to:"/signin",children:Object(E.jsx)("button",{children:"Login"})}),Object(E.jsx)(M.b,{to:"/signup",children:Object(E.jsx)("button",{children:"Registro"})})]})]}):Object(E.jsx)("div",{children:Object(E.jsxs)(P,{children:[Object(E.jsx)("h1",{children:"Happy Harvest"}),Object(E.jsx)(M.b,{to:"/Crops",children:Object(E.jsx)("button",{children:"Mis cultivos"})})]})})},Y=n(13),W=function(e){Object(p.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).harvestCrop=r.harvestCrop.bind(Object(u.a)(r)),r.growCrop=r.growCrop.bind(Object(u.a)(r)),r.updateSel=r.updateSel.bind(Object(u.a)(r)),r.selection="",r}return Object(c.a)(n,[{key:"updateSel",value:function(e){this.selection=e.target.value}},{key:"harvestCrop",value:function(){var e=this;if(this.props.elementInfo.lastProduction+36e5*this.props.elementInfo.cycleTime<=(new Date).getTime()){var t={method:"GET",headers:{Authorization:"Bearer ".concat(this.props.auth.authToken)}};console.log("*Hacker voice: Im in"),console.log(this.props.id),fetch("http://10.6.130.90/users/".concat(this.props.currentUser.username,"/Crops?position=").concat(this.props.id),t).then((function(e){return e.json()})).then((function(n){"res"==n.type&&"OK"==n.msg?fetch("http://10.6.130.90/users/".concat(e.props.currentUser.username),t).then((function(e){return e.json()})).then((function(t){"res"===t.type?e.props.onSetUser(t):e.props.onLogOut()})):"res"==n.type?alert(n.msg):console.log(n)})).catch((function(t){console.log(t),e.props.onLogOut()}))}}},{key:"growCrop",value:function(e){var t=this;if(""!==this.selection){var n={method:"POST",headers:{Authorization:"Bearer ".concat(this.props.auth.authToken)}},r={method:"GET",headers:{Authorization:"Bearer ".concat(this.props.auth.authToken)}};fetch("http://10.6.130.90/users/".concat(this.props.currentUser.username,"/Crops?type=").concat(this.selection),n).then((function(e){return e.json()})).then((function(e){if("res"==e.type&&"OK"==e.msg)fetch("http://10.6.130.90/users/".concat(t.props.currentUser.username),r).then((function(e){return e.json()})).then((function(e){"res"===e.type?t.props.onSetUser(e):t.props.onLogOut()}));else{if("res"!=e.type)throw new Error("Unexpected response");alert(e.msg)}})).catch((function(e){console.log(e),t.props.onLogOut()}))}}},{key:"render",value:function(){if(this.props.elementInfo){var e=new Date(this.props.elementInfo.lastProduction),t=new Date(this.props.elementInfo.lastProduction+36e5*this.props.elementInfo.cycleTime),n=Object(E.jsx)("p",{children:"En proceso de cultivo..."});return t.getTime()<(new Date).getTime()&&(n=Object(E.jsx)("button",{onClick:this.harvestCrop,children:"Cosechar"})),Object(E.jsxs)("div",{children:[Object(E.jsxs)("p",{children:["Nombre: ",this.props.elementInfo.type]}),Object(E.jsxs)("p",{children:["Fecha de cultivo: ",String(e.getDate())+"/"+String(e.getMonth()+1)+"/"+String(e.getFullYear())+" "+String(e.getHours())+":"+String(e.getMinutes())]}),Object(E.jsxs)("p",{children:["Fecha de recogida: ",String(t.getDate())+"/"+String(t.getMonth()+1)+"/"+String(t.getFullYear())+" "+String(t.getHours())+":"+String(t.getMinutes())]}),Object(E.jsx)("img",{src:this.props.elementInfo.icon.src,alt:"",style:{width:this.props.elementInfo.icon.width,height:this.props.elementInfo.icon.height}}),n]})}var r=[];r.push(Object(E.jsx)("option",{value:"",default:!0,children:" --- "}));for(var s=0;s<this.props.seeds.length;s++)r.push(Object(E.jsxs)("option",{value:this.props.seeds[s][1].type,children:[this.props.seeds[s][1].type," (",this.props.seeds[s][0],")"]}));return Object(E.jsxs)("div",{children:[Object(E.jsx)("p",{children:"Espacio disponible para cultivos"}),Object(E.jsxs)("form",{children:[Object(E.jsx)("select",{onChange:this.updateSel,children:r}),Object(E.jsx)("button",{type:"button",onClick:this.growCrop,children:"Plantar"})]})]})}}]),n}(s.a.Component),q=Object(C.a)(Object(d.b)((function(e,t){return{currentUser:e.currentUser,auth:e.auth}}),(function(e,t){return Object(h.a)({onSetUser:y,onLogOut:S},e)}))(W)),Q=function(e){Object(p.a)(n,e);var t=Object(l.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,e)}return Object(c.a)(n,[{key:"render",value:function(){if(""===this.props.currentUser.username)return Object(E.jsx)(B.a,{to:"/"});for(var e=[],t=0;t<this.props.currentUser.farmElements.cropSpaces;t++)this.props.currentUser.farmElements.currentCrops[t]?e.push(Object(E.jsx)(q,{elementInfo:Object(Y.a)({},this.props.currentUser.farmElements.currentCrops[t]),id:String(t)},String(t))):e.push(Object(E.jsx)(q,{seeds:this.props.currentUser.inventory.seeds},String(t)));return console.log(e),Object(E.jsx)("div",{children:Object(E.jsxs)(P,{children:[Object(E.jsx)(M.b,{to:"/",children:Object(E.jsx)("button",{children:"Volver"})}),e]})})}}]),n}(s.a.Component),Z=Object(d.b)((function(e,t){return{currentUser:e.currentUser}}),(function(e,t){return Object(h.a)({},e)}))(Q),$=function(e){Object(p.a)(n,e);var t=Object(l.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,e)}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.cookies,n=t.get("authToken"),r=t.get("authUser");if(n&&r){var s={method:"GET",headers:{Authorization:"Bearer ".concat(n)}};fetch("http://10.6.130.90/users/".concat(r),s).then((function(e){return e.json()})).then((function(n){"res"===n.type?(e.props.onSetUser(n),e.props.onSetToken(t.get("authToken"))):(t.set("authToken",void 0,{path:"/"}),t.set("authUser",void 0,{path:"/"}))})).catch((function(e){console.log(e)}))}else t.set("authToken",void 0,{path:"/"}),t.set("authUser",void 0,{path:"/"})}},{key:"render",value:function(){return Object(E.jsxs)(M.a,{children:[Object(E.jsx)(X,{}),Object(E.jsxs)(B.d,{children:[Object(E.jsx)(B.b,{exact:!0,path:"/",element:Object(E.jsx)(V,{props:{username:this.props.currentUser.username}})}),Object(E.jsx)(B.b,{path:"/signin",element:Object(E.jsx)(L,{props:{username:this.props.currentUser.username}})}),Object(E.jsx)(B.b,{path:"/signup",element:Object(E.jsx)(K,{props:{username:this.props.currentUser.username}})}),Object(E.jsx)(B.b,{path:"/Crops",element:Object(E.jsx)(Z,{})})]}),Object(E.jsx)(G,{})]})}}]),n}(s.a.Component),ee=Object(C.a)(Object(d.b)((function(e,t){return{auth:e.auth,currentUser:e.currentUser}}),(function(e,t){return Object(h.a)({onSetToken:k,onSetUser:y},e)}))($)),te=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,39)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),s(e),a(e),o(e)}))};var ne=n(38);var re=Object(h.b)({currentUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{username:"",fullname:"",email:"",registration:0,farmElements:{cropSpaces:0,animalSpaces:0,currentCrops:[],currentAnimals:[]},inventory:{currentCash:0,cropBoost:0,animalBoost:0,products:[],seeds:[]}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case U:return r;case x:return{username:"",fullname:"",email:"",registration:0,farmElements:{cropSpaces:0,animalSpaces:0,currentCrops:[],currentAnimals:[]},inventory:{currentCash:0,cropBoost:0,animalBoost:0,products:[],seeds:[]}};default:return e}},signIn:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{username:"",password:"",msg:""},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,s={};switch(n){case j:return void 0!=(s=Object(Y.a)({},e))[r.name]&&(s[r.name]=r.value),s;case g:return{username:"",password:"",msg:""};case b:return(s=Object(Y.a)({},e)).msg=r.msg,s;default:return e}},signUp:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{username:"",password:"",email:"",passwordRepeat:"",register:!1,validUser:"",validPassword:"",validEmail:""},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,s={};switch(n){case F:return void 0!=(s=Object(Y.a)({},e))[r.name]&&(s[r.name]=r.value),s;case A:return{username:"",password:"",email:"",passwordRepeat:"",register:!1,validUser:"",validPassword:"",validEmail:""};case R:return(s=Object(Y.a)({},e)).validUser=void 0===r.validUser?s.validUser:r.validUser,s.validPassword=void 0===r.validPassword?s.validPassword:r.validPassword,s.validEmail=void 0===r.validEmail?s.validEmail:r.validEmail,s;default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{authToken:""},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n==w?r:e}}),se=Object(h.c)(re,{currentUser:{username:"",fullname:"",email:"",registration:0,farmElements:{cropSpaces:0,animalSpaces:0,currentCrops:[],currentAnimals:[]},inventory:{currentCash:0,cropBoost:0,animalBoost:0,products:[],seeds:[]}},signIn:{username:"",password:"",msg:""},signUp:{username:"",password:"",email:"",passwordRepeat:"",register:!1,validUser:"",validPassword:"",validEmail:""},auth:{authToken:""}},window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());o.a.render(Object(E.jsx)(ne.a,{children:Object(E.jsx)(d.a,{store:se,children:Object(E.jsx)(ee,{})})}),document.getElementById("root")),te()}},[[35,1,2]]]);
//# sourceMappingURL=main.7fd343d6.chunk.js.map